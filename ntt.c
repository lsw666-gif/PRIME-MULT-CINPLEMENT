#include <stdint.h>
// #include "params.h"
#include "ntt.h"
int32_t psai[2048] = {
    -917984, 4119647, -3415389, 1417948, -763320, 2007846, -4123519, 2421664, -2767576, -742419, 2436517, -1142951, 3016405, -1670188, -1671186, -3560952, 2526228, -1596235, 58202, -2122718, 1800479, 994533, 4423443, -1714693, 4212790, 759016, 2029721, 2753982, 658535, 2201329, 1857544, 1183861, 4300311, -1947404, 2262405, 2284313, 4327578, -2018635, 1450464, -221625, -1421642, 1545891, -3927454, 991751, 3706133, -2186664, 2141640, 2598809, -1705619, 2321218, 683472, -594006, 1813311, 947554, -642786, 2706205, -2539558, 223621, 1593214, 546050, 3405829, 3499247, 307576, 1133698, 944833, 1051340, -586286, 2273378, -1403126, -4439118, -1504093, -4262665, 1888638, 178674, -2722373, -3635663, -1299621, 1109624, -2839382, 1131593, 77490, 1137719, -133278, -3168125, -2079958, 3149780, -3043276, 3840708, -1239392, -4166741, -187014, 3238759, -3524542, -3697222, 2094024, 4022977, -3249074, -1645294, 1623008, -3553874, 1892394, -4318327, -1552163, -1041582, 2282695, 1500019, -1916469, 2597963, -827743, 4170776, 4469981, -1395458, -465352, 481748, -1701953, 2635601, 1417542, 3839534, -895524, 1685596, 1216107, -10167, 1238805, 1936332, 1373033, -1927987, 406207, -3832703, 1924108, -680724, 1980818, -407099, 571021, 1351393, -2047222, -2304216, 1166422, -943499, -387386, 1430806, -2935305, -4225906, 3863557, -2684891, 2854366, -76100, -1016204, -1549575, 1053626, -1437237, -4048399, 1979254, -309515, -496796, 2344474, -1119132, -629169, 1464399, 886713, -1408531, 3340139, -3969940, 2315843, -2312278, 1179347, 4180821, 737256, 576101, -3351143, 960947, -2398784, 3805095, 8569, -68337, 2741220, -1747258, -1067606, 2992135, 2752328, -1712600, -2627800, 2294508, 3695014, -3025449, -3027887, 1144495, 467142, 4261377, 862324, -861012, 1200052, -2878613, 4468665, -4032605, -3559166, 2053828, 1095535, -1859190, 759444, -3028681, 3423840, -348999, 2988206, 2681258, -487767, 510107, 678852, 1763572, -334087, -309192, 3467083, -886034, -972812, 1483124, 290000, 2609697, 1445019, 4474755, -4472793, -3205829, -2560058, 301463, 4327607, -3966737, -3659229, 3225729, -1739309, 1497414, 689109, -1831705, -54291, 3261295, -891173, -809791, -2825352, -4090714, -2125358, 3846060, -1004074, -1656755, -1040940, -1146554, 137609, -3230155, 2847934, -4069901, 4156823, 2729178, 2605901, -3598785, 4164943, 3196039, -4096997, 2401285, 777937, 3950017, -73507, -2058297, -3987067, -2399338, 3494588, 3423285, -675267, -2488800, -297345, -1747951, 1904293, -3412652, 4117894, 2947723, 1743889, -2711017, 66302, 3391011, -3418829, 1352427, 1118826, 4383562, 395766, -3924902, 153873, -2982818, 2548130, 740964, -38883, 1140414, 2139562, -2857457, -3877413, -3781414, -748685, -3736281, -2499175, -3541931, 1436443, -850313, -4406073, 3892725, 4245660, 2659905, -3402055, -1798716, 2926973, -3602529, -2234084, -3412562, -3282674, 1669279, -1804332, 2920447, -3293505, 1543635, 1377311, 3257981, -1206079, 4082867, -765071, 1742946, -3568207, -2278452, 1360048, -861464, 1350196, -1017893, -1800145, 640477, -1917530, -1738424, 995819, -542791, 2574684, -194595, -612135, 4302060, 3391622, 1477722, 1840119, 3934955, 4078075, 4007869, 327020, 4407513, -3996141, -194238, -1980481, 3075031, -944187, 610426, 2450034, -3999700, -3322049, 3455944, 3914023, 1642892, 1946931, -3427867, -1862901, 995774, -3512924, 1888717, 2203585, -2530398, 371280, -3959404, -1666766, -198655, 4053106, -1231377, 1501343, 125657, 2295628, -2554217, -4072810, 918519, -4224665, -2351076, -3705663, -67841, -1938021, 1438184, 1514838, -4339346, -2807083, 344483, -1200583, -953361, -1863542, -1927709, -2150993, 1991916, -970378, 1232893, -1994075, 302891, -2720460, -1291541, -2299461, 1422329, 3297991, -2306337, 2379096, 4374218, -3549299, -1574894, -2372608, -1981982, -4151101, 1433217, -4115452, -3426749, 875511, -992288, 2926715, -2936211, 4411469, -1594135, -3742113, -2505219, -2686109, -2591122, 2960973, -457330, 4362249, -3520255, 4368506, -115164, -3325917, 2206314, -2595092, 2116175, -4071272, -555955, 1489717, 3718274, 2476394, 2850460, 2745354, -1392741, -295813, 3661492, 4325677, -231069, 2702473, 4453402, 1052449, 2018784, -311937, 3885123, -4457376, -2227944, -3946450, 2804938, 633250, 1524605, -2717640, 3080951, -2445053, 3623669, -2689060, -4335816, 1958285, 758546, -2883047, 2550363, 985515, -1196944, 2223744, -686894, -4350420, 4190446, 1183318, -871445, 948529, 2745182, 2652555, -2122197, 3731701, 464918, -1101104, -3322749, -910818, -1691292, 3992653, 1501487, -1253877, -475080, -1225816, 1357628, -1236146, 3684499, -3807843, 119330, 302248, 1365231, 1038651, 606036, 2286484, -584601, -1436518, 1876546, -16799, 509967, 2071781, 3607124, 1293351, -3024203, -257823, 2329757, 1203278, 1069734, 2174210, -345131, -888367, 1725652, -3209235, 1197453, 3007949, -1477420, 4072175, -1776158, 2257935, 2589425, -4455212, 3006216, -3786244, -3421222, -2782064, 1916320, -4139724, 1605684, 604726, -1609954, 471843, 2943410, -1179510, -637843, -3708054, 71337, -3183341, -3236921, -2511610, 1931898, 2809130, 404763, -2133488, -3047128, -2622045, -80477, 1585364, 3544559, 3868307, -2048067, 1204199, -4014608, -4072457, 3128861, 4268910, -2230690, 3301822, 1120190, -2413722, 3671471, -2806701, 606723, 1006203, -2176588, 3150703, 3650738, 1341606, 769751, -1536199, 3310687, -1429405, -1299906, -3729771, -4200586, 1521004, 549568, -2687409, 3263902, -4340909, -2681540, -4388614, -2068188, 633427, -181324, 4157052, 4010962, -627697, 4114924, -341690, 1218872, -3479843, -1126142, -4266745, 1842650, 1799949, 490120, -2661306, -3791581, -836885, 3845753, 3137177, 3408721, -4345501, 3350136, -2988531, -1217502, 273937, -29954, -1534177, 1418757, -839421, -4174081, -1312899, 2724723, 220402, 3984616, 2788507, 2881608, -428056, -1138983, -2377303, 1401829, 2292821, 532540, -4080026, 1447106, 2910238, 4026839, -1336824, -1048107, 2495249, -2761256, -4203666, 2318236, -1872557, -291252, -1145748, -1873194, -2676845, 957098, 3869455, -3555986, -4270013, 1332917, -28394, -140157, -1878168, -2034577, 4211584, -2786622, 110793, 2961000, 2164862, 2983877, -663593, 1495574, -202338, -1517588, 1883446, -3479308, 1464498, -1083449, 954054, -4239148, -3617969, 109088, -1588496, 1005954, 3876908, -3031584, 1559804, 664182, -921226, 628890, 49398, 3547752, 35616, 1677414, 1039608, -1033003, -752758, 1995681, -3855800, 3464844, 3340110, -2021838, 882179, 726941, 566480, -1906540, 802729, 1945431, -339797, -339899, -2796037, -85138, 560386, 95152, 2565561, 55714, -4171451, -541407, -3614991, 2200319, -2796647, 1698399, 2071930, -1772903, 4173465, -1121728, -104673, 1006045, 1629040, 2929916, 2838006, 2422103, 2178826, 1886569, -1943955, -1136024, -429762, -3809575, -604917, 1478834, -1136212, 2845757, 1113980, -2457483, -484985, 3731935, 4014269, 830906, -1733321, -4185065, -2293379, 4238710, 2733844, 3357229, -3816223, 2613426, 244436, 3521394, -536295, 1167622, 1972250, 2988799, -1318156, -2430460, -2966887, 1786015, -71846, 3017987, 3035448, 766055, -4346186, -2789855, 3474631, 2515028, 254953, -3034840, -3931786, 4062470, -771284, 1554363, 4346542, -2916642, -2676039, -1957036, -2141403, -1545820, -2961368, 1685602, -439336, -729429, 2253157, -1721497, 2462651, -3491414, 1736347, -4046235, -2833262, -3851123, 116244, 330464, -3642628, -2808763, 2813066, 4184516, -3103785, -774624, -2179386, -3770441, -3997656, -2733710, -4224893, -305299, 1619508, 2571448, 2458371, 2567018, -338582, -2645256, -3142249, -1548867, -3796144, -2204881, 2717474, -570895, -2662876, -1401927, -1794704, 533375, 77886, 3237008, 4231043, -3297958, -3334802, -2112588, 991386, -2414576, -164641, -2300747, -433408, -221065, 1359410, -2752025, -2148030, -1081463, 3226721, 2137932, -945840, 4255108, -3030000, -4429513, -4129345, 1233604, -3867563, -1330346, 1133359, -680869, -2010289, -3611855, -176117, -760596, -2930507, 3987909, 158525, 2694185, -920584, -2069827, 874094, 377822, -365524, -4037781, 2622554, 2304197, 3248601, 2866877, -1454019, 2326312, 1525808, 1879466, 2648307, 3021055, -1151728, 3580490, -203327, 1036631, -56373, 2394307, 218037, 1142770, -4424751, -1151249, -1236568, -4383527, 1493442, 3464014, 2455130, 2403822, -619206, 4039898, 3287999, -2933734, 1054221, 564377, -1269804, 1945515, 2404350, 343922, -358590, -3213665, -921650, 3805264, -2339796, 3815111, 9905, -2478058, 3244200, 79912, 3234808, 192412, 1643568, -872798, 2501443, -3148005, 4114261, -3904040, 1255354, 1863888, -149, -3569734, -3663498, 1138527, 2212046, -3984883, -323773, -2178473, -663796, -2767234, -1109092, -3089847, 4296518, -4223267, 1323712, 153150, 928365, 2163395, -827529, 287950, -425660, -2539878, 3916325, 692898, 3245082, -532894, -3009713, 2703032, -290266, -1714584, 3809577, -2724401, 933176, -63063, 514110, 3470082, 889825, -912176, 375235, 395681, -909788, -2061925, -3177936, 2160435, -447645, -3622049, 1913329, 2181345, -1355064, 1518355, -2542368, 2277456, 1808657, -2434810, 2596557, 4090706, 3608740, -3539566, -2596414, -2586816, -3993229, -2927769, -1719229, 6668, 3248593, 3095672, 1386713, 622047, 1224117, 1365185, -1955723, 4280264, 2902439, -2264261, 3681942, 3885380, 2744674, 155312, 2265896, 2009986, 3974200, 2328575, -1364347, -2605197, -151181, 2066269, 1893362, 3796522, -422730, 924123, -146078, -4036326, -4442653, -1539055, -2461782, 4369120, 2995043, 2923353, 651677, 3678541, 87174, -2850918, 710740, 2662324, -916723, 2736159, 2481731, -3232068, 3160639, -3070061, 718893, -3408195, -178810, -3171608, -3011804, -1262722, 2711390, -1092637, -2328100, 457978, -2653838, 1897431, -2215622, -1140884, -1415065, -4200818, 3054036, 1671652, -2982523, -2997088, 3249023, 1985142, -2278092, 2222193, -2696954, 4395946, -3131841, -3869049, -467673, 856410, -1628075, 4152011, -2206550, -1051345, -407999, 1384217, 2256074, 3233016, 4029471, 2364056, -3487745, -1115346, -2338438, 3013644, 3606877, -601336, -1479759, 118942, 2942168, 1486977, 2731859, 3072262, -4142863, 762792, 341605, 2330795, -438550, 1403305, 4000919, -4444601, -2375615, -2125111, -507785, 2465132, -3956671, 895757, 157892, -458093, 2556463, 2947199, -1741524, -3396898, 4265535, -799010, -1699103, -562209, -3805734, 1332855, 1422203, 3665542, 1142812, -3656651, 3130328, -965062, 1468851, 3076286, 1625491, -1849314, 1201331, 1935431, -558075, 2053620, 1105379, -1473966, -3768772, -1922886, -3743472, 3918448, -1148692, 1775517, 2165554, -3382249, 2563349, -3805676, 1687292, -2860211, 3874950, -2970014, 195770, 1413302, -4242492, -3765115, 1440499, -502485, 3672923, 1161354, -2915390, 120965, 3356643, -1636692, -2263997, -1502913, 2793573, -1044090, 3246894, -3131276, 2960982, 2641436, 919538, 2898050, 733955, -2346013, -2980933, -1483849, -4277255, -4107233, 1746988, -724150, 889262, -3828970, 2930506, 1634291, -1699152, -2517000, 3999318, 2187794, -2419166, 2745651, -671293, 2441617, -2924900, 1370751, 2373091, -1763035, 1174819, -567624, 527450, 2319262, 1604196, 1946789, -2216519, 3257073, -3075967, -2060749, -558922, 2784168, -4448864, -4022277, -3267423, -3792541, 2054196, 1984357, 1936555, -2022865, 1899344, -3951801, -1016667, -2851426, -2989604, -735816, 1114368, -129399, 2536652, -4374007, -3728120, 3399132, 4244707, -290334, -2480305, -3989037, -2806524, -1099206, 1596402, 3343733, -3646196, 786436, 2821606, -2885480, -3411556, 2549836, 695999, -4224097, 3652560, 677242, 2106275, 3811433, -2711681, -653426, 278783, -2138670, -1367064, -4329824, -505174, 508972, -3239793, -4176864, -3477306, 1271492, 1084212, -1338583, 4365753, 3664667, 142183, 2440159, 4338785, -3696595, 571207, 2744230, 1384759, -3905661, 2282813, 362733, 2666659, -2748537, -605036, -711441, -1359145, -1470649, 676185, -3628464, 3410633, -4120616, 3987361, -3771438, -23210, 3746620, 575210, -3223216, -441876, -4159985, -3417600, 884119, -3331566, -687675, 3112961, -2110172, 1047595, 4356295, 3553306, -32069, 3207650, -3972409, -2478957, -2267070, 2159783, -549674, -3266376, -1293203, 4181429, -668245, -3969584, -96875, 2716716, 970469, 146013, 2539125, -3903800, -2028350, 3366703, 1520828, -3047036, 3977226, 3403155, 1663567, -2069577, 483061, -3037072, 930525, -1322258, -3700157, 358523, 4011103, -2287398, 2112587, -3812292, -1294865, -889794, -3330565, 20393, 1863571, -1581100, -195640, -3987536, 3182728, 2327650, -3250341, -4476162, 291695, -1535852, 3455185, -3018962, 4319422, -712405, -3149330, 3841325, -2296617, -3232057, -1677604, 1934746, 1608439, -4112090, -3367917, -1290613, 3029523, 1025087, -786645, -3109225, 2660039, -2171095, 1874408, -1960853, 1086561, 3712796, 794282, 4293620, 347313, 106290, 853731, -116619, -4149060, 909490, 3872218, -2411470, -2560875, -4078024, -4347717, -2374386, -2593419, -2217417, 4327469, -1239476, 2710487, -870835, -2966855, -3665747, -545966, 2520526, -1855737, -1232646, -2440823, 3801923, -856489, 1365224, 3254108, 4278118, 2919095, -3500810, 2239127, 3082966, 4382066, 2202009, -2206588, -1377848, -206038, 1548434, -3064641, 1769745, 653706, -2456982, 1338535, 3015924, -219810, 2943503, -4250305, -3396733, -4096093, 1689713, -1619930, 880209, -3343177, -4253895, -956558, -4128032, 2837829, -4171814, -228315, -1301198, -1894127, -3705886, 716219, 3811276, 3502547, 2865501, 305095, 665896, 881993, 3687180, -484530, -1175599, 500734, 3166673, 1119090, 3599603, 3823455, -424178, -2412787, 3834777, 1501990, 2556802, 3320492, -1853633, -45284, -1968551, -262035, -2059605, -2792435, 2029230, -2221967, 2621882, 3623455, 2359501, -174692, 53220, 3875513, 3495747, 2719493, 2473693, 668243, -1672228, 1627754, 4124175, -3283332, 1652927, -3397679, -2603163, 3604105, 2420740, -774822, 2191050, 1328488, -1241984, -1635249, -2109717, -1582315, -2825055, -278807, 1927639, -2099026, 668256, -3964205, 2470045, -2398369, -1674364, 67692, 799494, 3848079, -4466185, -4245518, 1586854, 3442855, 2931065, 190602, 2106778, 3969309, 3780384, -3506780, 1957109, -1407633, 2735699, 647794, -2288832, 612726, -4294103, 3397704, 2674060, 3737913, -2909148, -1638554, 1047365, -253050, -1735283, 465783, -438020, 1907718, 1863208, 292699, -1552552, 2252534, -460381, 2629151, 89844, 3574040, -182914, -2146666, 656237, -1437955, 3300065, -1210554, -2363491, -4298135, 205874, -1162431, 1293109, -2815475, 2474477, -3854145, 3135315, 724751, -2109151, 2367401, 628417, 2142809, -672141, -155396, 3939718, -2693807, -2756872, -2578255, 3912852, -1785004, 3824590, -3617010, -2770165, 2821995, 2911756, -1350528, 2710306, -1415078, -1110105, 150757, 1878128, 3178552, -2197587, 3274246, -1619248, 3417356, 3459215, -4085057, 1271155, 809374, 3393895, 2475830, 964252, 1683979, 1079499, -4152304, -3636229, -1227343, -4189908, -4074802, -76083, 15605, 3703545, -4244450, 677679, 630315, 1397759, 192426, -954357, -1638603, -1098243, 3233329, 1913857, -3969364, 4359014, -1617607, -49841, -946710, -2888029, -401167, 2180089, -1791558, -3021741, 2130516, -1706894, 1867657, -937173, -853408, 2000638, 1063112, -594974, 151440, -1912813, -3513981, -1346571, -851310, 432515, 29744, 1018689, 959496, 3152096, 2967013, -3303693, 2046835, -2026497, 3489004, 1698553, -3845097, 3377036, 226879, 4189956, 2702032, -3368774, -1583689, -3503386, 4313029, 2995231, 2021551, -2979411, -2500733, 2159859, 1751654, -1267186, -3567001, -1640885, -3142517, -4468027, -3026595, -3819334, -3505129, 2827360, 361735, -1595511, -857773, -2263380, 2106955, 2001054, -1884467, 3173590, -926765, -4124403, -3620652, -1491180, -3270033, 4259059, 940442, 1375071, -4277507, 1441470, -304475, -2974770, 2372143, 1904485, 46029, 349686, -1680569, 34712, 681966, 1378013, 3318182, -1244707, 3524041, -3378409, 4359739, 3002723, -1925583, 61707, -559996, 2112078, 63678, -1000763, -1258075, 3204908, 611549, -736235, -4045500, 1041062, 4369751, -1156831, 733324, 3990294, 725485, -294951, -854207, -981211, 3401888, -1811005, 2462935, -3385281, 3999902, 3122403, 3059680, 987005, -1298648, -3013763, 4421048, 378403, -709529, -1926990, -4156047, -1363272, 3568239, -4095512, 3561298, -3434435, -2051217, -1923618, 2329112, 516511, 807470, 2245471, 1061595, -1933524, 1479609, 2277907, -287469, 3854539, -2081356, 2080294, -3809409, -3171201, 3082226, 2372207, 1144410, -1563860, -1012010, 732959, 3764562, -860798, 4204611, -3571928, 2336291, 111848, -3718218, 536530, 2180006, 2604440, 3504578, -1483601, -4111712, 858766, 210753, -321490, -3703799, 2773925, -2958513, -1225191, -4211060, 4080150, -518548, 622635, 4171257, 1538154, -4405179, 3370010, -2440975, -4146930, -389163, 3342104, 1361895, -546055, 2854931, -1398646, 1682097, 2150570, -4437742, -1684785, 3878386, 454992, 465664, -1844145, -2903324, -414326, -2256358, -2244519, -1438917, 3716988, -2747405, 2064277, 3422570, -912969, 533797, 2821593, -1394968, 3770405, 3325072, -4158275, -1476810, -1357747, -3416091, -4386677, -410451, 195129, -1510181, -2801759, -4247533, -2337492, 570478, -662103, 1393870, 633598, -3953097, -1814644, 2495089, 4387832, 4295937, 1627111, 1043384, -953140, 2711162, -3698195, -3328590, 4305998, 2097249, 1225915, -3070246, -1595697, -2250610, 3609676, -3459298, -2647918, 2634590, 4455335, 3544542, -1907750, 477160, 4296709, -4092147, 854240, 2117430, 500180, 1357571, 4375141, -808316, -1948793, 743897, -393029, 602661, -1819889, 1471594, -1978509, -4099251, -2720017, -3892583, 1884882, -4274086, 985888, -4033470, -4222250, -3176639, -677179, -1505361, -1061127, 2285605, -2564358, 2457002, 3416812, -722214, 4157839, 521496, -3896326, -3223255, 1369159, 3706300, 3602630, -1080284, 1396746, 3433030, 3691005, 876153, -2843620, 3751411, -1640431, 4010329, -1355218, -789662, -2304413, -149742, 2713426, -1147518, -1522208, 2559916, -584106, -1899813, 472422, -3547147, -4316025, -2842388, 3421370, -3544071, -2741071, -3632769, 3731835, -1129958, -3172993, 633740, -3481322, -220311, -4330468, -2589341, -1750402, -2322395, 2861174, 2114097, 1133473, 2771123, -2285511, -1512028, 1153497, 2881942, 2029643, 2747293, 763308, 2810227, -1589234, -2499550, -213142, -1296695, 2112640, -347089, 1244928, -2013462, -787185, 993934, 2008770, -3288100, 3884668, -1218709, -4010666, -4308363, 3505424, 2287212, -1959968, 1506677, -2560733, 587799, 2987863, -2052518, 3318825, -749169, 1193849, 3359131, 640150, -3391221, 1033342, 1412901, 1120984, -1397883, -2706233, -4316884, 4126790, -879009, 1713343, -3953646, -2257884, -2929273, -3120469, -2434865, -4358957, 3343603, 2112034, -3152830, 751391, -4292980, 878742, 1694342, 4400607, 2522962, 4316428, 1385321, -2101221, -2919058, -2791190, 1133707, 132085, -1868025, 763775, -477200, -3981654, 2769223, -3274075, 2980401, -1269377, -197937, 2151373, 564963, 191075, -4152648, 42104, 4069650, 24653, 852007, 3692036, 3833081, 2749104, 994175, 186284, 1976703, -1539566, -4436189, 3938276, -3964873, 1841364, 3009057, -809534, -3102706, 3647597, -1698956, 1231962, -371607, 3431629, -484226, -3177415, -433918, -977260, 3396490, 305273, -1243869, 4321255, -1298727, -3250192, 1242084, -2374113, 1904873, -2232439, 2121312 };
int32_t psaiinv[2048] = {
    -917984, -4119647, -1417948, 3415389, -2421664, 4123519, -2007846, 763320, 3560952, 1671186, 1670188, -3016405, 1142951, -2436517, 742419, 2767576, -1183861, -1857544, -2201329, -658535, -2753982, -2029721, -759016, -4212790, 1714693, -4423443, -994533, -1800479, 2122718, -58202, 1596235, -2526228, -1133698, -307576, -3499247, -3405829, -546050, -1593214, -223621, 2539558, -2706205, 642786, -947554, -1813311, 594006, -683472, -2321218, 1705619, -2598809, -2141640, 2186664, -3706133, -991751, 3927454, -1545891, 1421642, 221625, -1450464, 2018635, -4327578, -2284313, -2262405, 1947404, -4300311, 3832703, -406207, 1927987, -1373033, -1936332, -1238805, 10167, -1216107, -1685596, 895524, -3839534, -1417542, -2635601, 1701953, -481748, 465352, 1395458, -4469981, -4170776, 827743, -2597963, 1916469, -1500019, -2282695, 1041582, 1552163, 4318327, -1892394, 3553874, -1623008, 1645294, 3249074, -4022977, -2094024, 3697222, 3524542, -3238759, 187014, 4166741, 1239392, -3840708, 3043276, -3149780, 2079958, 3168125, 133278, -1137719, -77490, -1131593, 2839382, -1109624, 1299621, 3635663, 2722373, -178674, -1888638, 4262665, 1504093, 4439118, 1403126, -2273378, 586286, -1051340, -944833, -3950017, -777937, -2401285, 4096997, -3196039, -4164943, 3598785, -2605901, -2729178, -4156823, 4069901, -2847934, 3230155, -137609, 1146554, 1040940, 1656755, 1004074, -3846060, 2125358, 4090714, 2825352, 809791, 891173, -3261295, 54291, 1831705, -689109, -1497414, 1739309, -3225729, 3659229, 3966737, -4327607, -301463, 2560058, 3205829, -4476968, -4474755, -1445019, -2609697, -290000, -1483124, 972812, 886034, -3467083, 309192, 334087, -1763572, -678852, -510107, 487767, -2681258, -2988206, 348999, -3423840, 3028681, -759444, 1859190, -1095535, -2053828, 3559166, 4032605, -4468665, 2878613, -1200052, 861012, -862324, -4261377, -467142, -1144495, 3027887, 3025449, -3695014, -2294508, 2627800, 1712600, -2752328, -2992135, 1067606, 1747258, -2741220, 68337, -8569, -3805095, 2398784, -960947, 3351143, -576101, -737256, -4180821, -1179347, 2312278, -2315843, 3969940, -3340139, 1408531, -886713, -1464399, 629169, 1119132, -2344474, 496796, 309515, -1979254, 4048399, 1437237, -1053626, 1549575, 1016204, 76100, -2854366, 2684891, -3863557, 4225906, 2935305, -1430806, 387386, 943499, -1166422, 2304216, 2047222, -1351393, -571021, 407099, -1980818, 680724, -1924108, 345131, -2174210, -1069734, -1203278, -2329757, 257823, 3024203, -1293351, -3607124, -2071781, -509967, 16799, -1876546, 1436518, 584601, -2286484, -606036, -1038651, -1365231, -302248, -119330, 3807843, -3684499, 1236146, -1357628, 1225816, 475080, 1253877, -1501487, -3992653, 1691292, 910818, 3322749, 1101104, -464918, -3731701, 2122197, -2652555, -2745182, -948529, 871445, -1183318, -4190446, 4350420, 686894, -2223744, 1196944, -985515, -2550363, 2883047, -758546, -1958285, 4335816, 2689060, -3623669, 2445053, -3080951, 2717640, -1524605, -633250, -2804938, 3946450, 2227944, 4457376, -3885123, 311937, -2018784, -1052449, -4453402, -2702473, 231069, -4325677, -3661492, 295813, 1392741, -2745354, -2850460, -2476394, -3718274, -1489717, 555955, 4071272, -2116175, 2595092, -2206314, 3325917, 115164, -4368506, 3520255, -4362249, 457330, -2960973, 2591122, 2686109, 2505219, 3742113, 1594135, -4411469, 2936211, -2926715, 992288, -875511, 3426749, 4115452, -1433217, 4151101, 1981982, 2372608, 1574894, 3549299, -4374218, -2379096, 2306337, -3297991, -1422329, 2299461, 1291541, 2720460, -302891, 1994075, -1232893, 970378, -1991916, 2150993, 1927709, 1863542, 953361, 1200583, -344483, 2807083, 4339346, -1514838, -1438184, 1938021, 67841, 3705663, 2351076, 4224665, -918519, 4072810, 2554217, -2295628, -125657, -1501343, 1231377, -4053106, 198655, 1666766, 3959404, -371280, 2530398, -2203585, -1888717, 3512924, -995774, 1862901, 3427867, -1946931, -1642892, -3914023, -3455944, 3322049, 3999700, -2450034, -610426, 944187, -3075031, 1980481, 194238, 3996141, -4407513, -327020, -4007869, -4078075, -3934955, -1840119, -1477722, -3391622, -4302060, 612135, 194595, -2574684, 542791, -995819, 1738424, 1917530, -640477, 1800145, 1017893, -1350196, 861464, -1360048, 2278452, 3568207, -1742946, 765071, -4082867, 1206079, -3257981, -1377311, -1543635, 3293505, -2920447, 1804332, -1669279, 3282674, 3412562, 2234084, 3602529, -2926973, 1798716, 3402055, -2659905, -4245660, -3892725, 4406073, 850313, -1436443, 3541931, 2499175, 3736281, 748685, 3781414, 3877413, 2857457, -2139562, -1140414, 38883, -740964, -2548130, 2982818, -153873, 3924902, -395766, -4383562, -1118826, -1352427, 3418829, -3391011, -66302, 2711017, -1743889, -2947723, -4117894, 3412652, -1904293, 1747951, 297345, 2488800, 675267, -3423285, -3494588, 2399338, 3987067, 2058297, 73507, 3408195, -718893, 3070061, -3160639, 3232068, -2481731, -2736159, 916723, -2662324, -710740, 2850918, -87174, -3678541, -651677, -2923353, -2995043, -4369120, 2461782, 1539055, 4442653, 4036326, 146078, -924123, 422730, -3796522, -1893362, -2066269, 151181, 2605197, 1364347, -2328575, -3974200, -2009986, -2265896, -155312, -2744674, -3885380, -3681942, 2264261, -2902439, -4280264, 1955723, -1365185, -1224117, -622047, -1386713, -3095672, -3248593, -6668, 1719229, 2927769, 3993229, 2586816, 2596414, 3539566, -3608740, -4090706, -2596557, 2434810, -1808657, -2277456, 2542368, -1518355, 1355064, -2181345, -1913329, 3622049, 447645, -2160435, 3177936, 2061925, 909788, -395681, -375235, 912176, -889825, -3470082, -514110, 63063, -933176, 2724401, -3809577, 1714584, 290266, -2703032, 3009713, 532894, -3245082, -692898, -3916325, 2539878, 425660, -287950, 827529, -2163395, -928365, -153150, -1323712, 4223267, -4296518, 3089847, 1109092, 2767234, 663796, 2178473, 323773, 3984883, -2212046, -1138527, 3663498, 3569734, 149, -1863888, -1255354, 3904040, -4114261, 3148005, -2501443, 872798, -1643568, -192412, -3234808, -79912, -3244200, 2478058, -9905, -3815111, 2339796, -3805264, 921650, 3213665, 358590, -343922, -2404350, -1945515, 1269804, -564377, -1054221, 2933734, -3287999, -4039898, 619206, -2403822, -2455130, -3464014, -1493442, 4383527, 1236568, 1151249, 4424751, -1142770, -218037, -2394307, 56373, -1036631, 203327, -3580490, 1151728, -3021055, -2648307, -1879466, -1525808, -2326312, 1454019, -2866877, -3248601, -2304197, -2622554, 4037781, 365524, -377822, -874094, 2069827, 920584, -2694185, -158525, -3987909, 2930507, 760596, 176117, 3611855, 2010289, 680869, -1133359, 1330346, 3867563, -1233604, 4129345, 4429513, 3030000, -4255108, 945840, -2137932, -3226721, 1081463, 2148030, 2752025, -1359410, 221065, 433408, 2300747, 164641, 2414576, -991386, 2112588, 3334802, 3297958, -4231043, -3237008, -77886, -533375, 1794704, 1401927, 2662876, 570895, -2717474, 2204881, 3796144, 1548867, 3142249, 2645256, 338582, -2567018, -2458371, -2571448, -1619508, 305299, 4224893, 2733710, 3997656, 3770441, 2179386, 774624, 3103785, -4184516, -2813066, 2808763, 3642628, -330464, -116244, 3851123, 2833262, 4046235, -1736347, 3491414, -2462651, 1721497, -2253157, 729429, 439336, -1685602, 2961368, 1545820, 2141403, 1957036, 2676039, 2916642, -4346542, -1554363, 771284, -4062470, 3931786, 3034840, -254953, -2515028, -3474631, 2789855, 4346186, -766055, -3035448, -3017987, 71846, -1786015, 2966887, 2430460, 1318156, -2988799, -1972250, -1167622, 536295, -3521394, -244436, -2613426, 3816223, -3357229, -2733844, -4238710, 2293379, 4185065, 1733321, -830906, -4014269, -3731935, 484985, 2457483, -1113980, -2845757, 1136212, -1478834, 604917, 3809575, 429762, 1136024, 1943955, -1886569, -2178826, -2422103, -2838006, -2929916, -1629040, -1006045, 104673, 1121728, -4173465, 1772903, -2071930, -1698399, 2796647, -2200319, 3614991, 541407, 4171451, -55714, -2565561, -95152, -560386, 85138, 2796037, 339899, 339797, -1945431, -802729, 1906540, -566480, -726941, -882179, 2021838, -3340110, -3464844, 3855800, -1995681, 752758, 1033003, -1039608, -1677414, -35616, -3547752, -49398, -628890, 921226, -664182, -1559804, 3031584, -3876908, -1005954, 1588496, -109088, 3617969, 4239148, -954054, 1083449, -1464498, 3479308, -1883446, 1517588, 202338, -1495574, 663593, -2983877, -2164862, -2961000, -110793, 2786622, -4211584, 2034577, 1878168, 140157, 28394, -1332917, 4270013, 3555986, -3869455, -957098, 2676845, 1873194, 1145748, 291252, 1872557, -2318236, 4203666, 2761256, -2495249, 1048107, 1336824, -4026839, -2910238, -1447106, 4080026, -532540, -2292821, -1401829, 2377303, 1138983, 428056, -2881608, -2788507, -3984616, -220402, -2724723, 1312899, 4174081, 839421, -1418757, 1534177, 29954, -273937, 1217502, 2988531, -3350136, 4345501, -3408721, -3137177, -3845753, 836885, 3791581, 2661306, -490120, -1799949, -1842650, 4266745, 1126142, 3479843, -1218872, 341690, -4114924, 627697, -4010962, -4157052, 181324, -633427, 2068188, 4388614, 2681540, 4340909, -3263902, 2687409, -549568, -1521004, 4200586, 3729771, 1299906, 1429405, -3310687, 1536199, -769751, -1341606, -3650738, -3150703, 2176588, -1006203, -606723, 2806701, -3671471, 2413722, -1120190, -3301822, 2230690, -4268910, -3128861, 4072457, 4014608, -1204199, 2048067, -3868307, -3544559, -1585364, 80477, 2622045, 3047128, 2133488, -404763, -2809130, -1931898, 2511610, 3236921, 3183341, -71337, 3708054, 637843, 1179510, -2943410, -471843, 1609954, -604726, -1605684, 4139724, -1916320, 2782064, 3421222, 3786244, -3006216, 4455212, -2589425, -2257935, 1776158, -4072175, 1477420, -3007949, -1197453, 3209235, -1725652, 888367, -2121312, 2232439, -1904873, 2374113, -1242084, 3250192, 1298727, -4321255, 1243869, -305273, -3396490, 977260, 433918, 3177415, 484226, -3431629, 371607, -1231962, 1698956, -3647597, 3102706, 809534, -3009057, -1841364, 3964873, -3938276, 4436189, 1539566, -1976703, -186284, -994175, -2749104, -3833081, -3692036, -852007, -24653, -4069650, -42104, 4152648, -191075, -564963, -2151373, 197937, 1269377, -2980401, 3274075, -2769223, 3981654, 477200, -763775, 1868025, -132085, -1133707, 2791190, 2919058, 2101221, -1385321, -4316428, -2522962, -4400607, -1694342, -878742, 4292980, -751391, 3152830, -2112034, -3343603, 4358957, 2434865, 3120469, 2929273, 2257884, 3953646, -1713343, 879009, -4126790, 4316884, 2706233, 1397883, -1120984, -1412901, -1033342, 3391221, -640150, -3359131, -1193849, 749169, -3318825, 2052518, -2987863, -587799, 2560733, -1506677, 1959968, -2287212, -3505424, 4308363, 4010666, 1218709, -3884668, 3288100, -2008770, -993934, 787185, 2013462, -1244928, 347089, -2112640, 1296695, 213142, 2499550, 1589234, -2810227, -763308, -2747293, -2029643, -2881942, -1153497, 1512028, 2285511, -2771123, -1133473, -2114097, -2861174, 2322395, 1750402, 2589341, 4330468, 220311, 3481322, -633740, 3172993, 1129958, -3731835, 3632769, 2741071, 3544071, -3421370, 2842388, 4316025, 3547147, -472422, 1899813, 584106, -2559916, 1522208, 1147518, -2713426, 149742, 2304413, 789662, 1355218, -4010329, 1640431, -3751411, 2843620, -876153, -3691005, -3433030, -1396746, 1080284, -3602630, -3706300, -1369159, 3223255, 3896326, -521496, -4157839, 722214, -3416812, -2457002, 2564358, -2285605, 1061127, 1505361, 677179, 3176639, 4222250, 4033470, -985888, 4274086, -1884882, 3892583, 2720017, 4099251, 1978509, -1471594, 1819889, -602661, 393029, -743897, 1948793, 808316, -4375141, -1357571, -500180, -2117430, -854240, 4092147, -4296709, -477160, 1907750, -3544542, -4455335, -2634590, 2647918, 3459298, -3609676, 2250610, 1595697, 3070246, -1225915, -2097249, -4305998, 3328590, 3698195, -2711162, 953140, -1043384, -1627111, -4295937, -4387832, -2495089, 1814644, 3953097, -633598, -1393870, 662103, -570478, 2337492, 4247533, 2801759, 1510181, -195129, 410451, 4386677, 3416091, 1357747, 1476810, 4158275, -3325072, -3770405, 1394968, -2821593, -533797, 912969, -3422570, -2064277, 2747405, -3716988, 1438917, 2244519, 2256358, 414326, 2903324, 1844145, -465664, -454992, -3878386, 1684785, 4437742, -2150570, -1682097, 1398646, -2854931, 546055, -1361895, -3342104, 389163, 4146930, 2440975, -3370010, 4405179, -1538154, -4171257, -622635, 518548, -4080150, 4211060, 1225191, 2958513, -2773925, 3703799, 321490, -210753, -858766, 4111712, 1483601, -3504578, -2604440, -2180006, -536530, 3718218, -111848, -2336291, 3571928, -4204611, 860798, -3764562, -732959, 1012010, 1563860, -1144410, -2372207, -3082226, 3171201, 3809409, -2080294, 2081356, -3854539, 287469, -2277907, -1479609, 1933524, -1061595, -2245471, -807470, -516511, -2329112, 1923618, 2051217, 3434435, -3561298, 4095512, -3568239, 1363272, 4156047, 1926990, 709529, -378403, -4421048, 3013763, 1298648, -987005, -3059680, -3122403, -3999902, 3385281, -2462935, 1811005, -3401888, 981211, 854207, 294951, -725485, -3990294, -733324, 1156831, -4369751, -1041062, 4045500, 736235, -611549, -3204908, 1258075, 1000763, -63678, -2112078, 559996, -61707, 1925583, -3002723, -4359739, 3378409, -3524041, 1244707, -3318182, -1378013, -681966, -34712, 1680569, -349686, -46029, -1904485, -2372143, 2974770, 304475, -1441470, 4277507, -1375071, -940442, -4259059, 3270033, 1491180, 3620652, 4124403, 926765, -3173590, 1884467, -2001054, -2106955, 2263380, 857773, 1595511, -361735, -2827360, 3505129, 3819334, 3026595, 4468027, 3142517, 1640885, 3567001, 1267186, -1751654, -2159859, 2500733, 2979411, -2021551, -2995231, -4313029, 3503386, 1583689, 3368774, -2702032, -4189956, -226879, -3377036, 3845097, -1698553, -3489004, 2026497, -2046835, 3303693, -2967013, -3152096, -959496, -1018689, -29744, -432515, 851310, 1346571, 3513981, 1912813, -151440, 594974, -1063112, -2000638, 853408, 937173, -1867657, 1706894, -2130516, 3021741, 1791558, -2180089, 401167, 2888029, 946710, 49841, 1617607, -4359014, 3969364, -1913857, -3233329, 1098243, 1638603, 954357, -192426, -1397759, -630315, -677679, 4244450, -3703545, -15605, 76083, 4074802, 4189908, 1227343, 3636229, 4152304, -1079499, -1683979, -964252, -2475830, -3393895, -809374, -1271155, 4085057, -3459215, -3417356, 1619248, -3274246, 2197587, -3178552, -1878128, -150757, 1110105, 1415078, -2710306, 1350528, -2911756, -2821995, 2770165, 3617010, -3824590, 1785004, -3912852, 2578255, 2756872, 2693807, -3939718, 155396, 672141, -2142809, -628417, -2367401, 2109151, -724751, -3135315, 3854145, -2474477, 2815475, -1293109, 1162431, -205874, 4298135, 2363491, 1210554, -3300065, 1437955, -656237, 2146666, 182914, -3574040, -89844, -2629151, 460381, -2252534, 1552552, -292699, -1863208, -1907718, 438020, -465783, 1735283, 253050, -1047365, 1638554, 2909148, -3737913, -2674060, -3397704, 4294103, -612726, 2288832, -647794, -2735699, 1407633, -1957109, 3506780, -3780384, -3969309, -2106778, -190602, -2931065, -3442855, -1586854, 4245518, 4466185, -3848079, -799494, -67692, 1674364, 2398369, -2470045, 3964205, -668256, 2099026, -1927639, 278807, 2825055, 1582315, 2109717, 1635249, 1241984, -1328488, -2191050, 774822, -2420740, -3604105, 2603163, 3397679, -1652927, 3283332, -4124175, -1627754, 1672228, -668243, -2473693, -2719493, -3495747, -3875513, -53220, 174692, -2359501, -3623455, -2621882, 2221967, -2029230, 2792435, 2059605, 262035, 1968551, 45284, 1853633, -3320492, -2556802, -1501990, -3834777, 2412787, 424178, -3823455, -3599603, -1119090, -3166673, -500734, 1175599, 484530, -3687180, -881993, -665896, -305095, -2865501, -3502547, -3811276, -716219, 3705886, 1894127, 1301198, 228315, 4171814, -2837829, 4128032, 956558, 4253895, 3343177, -880209, 1619930, -1689713, 4096093, 3396733, 4250305, -2943503, 219810, -3015924, -1338535, 2456982, -653706, -1769745, 3064641, -1548434, 206038, 1377848, 2206588, -2202009, -4382066, -3082966, -2239127, 3500810, -2919095, -4278118, -3254108, -1365224, 856489, -3801923, 2440823, 1232646, 1855737, -2520526, 545966, 3665747, 2966855, 870835, -2710487, 1239476, -4327469, 2217417, 2593419, 2374386, 4347717, 4078024, 2560875, 2411470, -3872218, -909490, 4149060, 116619, -853731, -106290, -347313, -4293620, -794282, -3712796, -1086561, 1960853, -1874408, 2171095, -2660039, 3109225, 786645, -1025087, -3029523, 1290613, 3367917, 4112090, -1608439, -1934746, 1677604, 3232057, 2296617, -3841325, 3149330, 712405, -4319422, 3018962, -3455185, 1535852, -291695, -4473599, 3250341, -2327650, -3182728, 3987536, 195640, 1581100, -1863571, -20393, 3330565, 889794, 1294865, 3812292, -2112587, 2287398, -4011103, -358523, 3700157, 1322258, -930525, 3037072, -483061, 2069577, -1663567, -3403155, -3977226, 3047036, -1520828, -3366703, 2028350, 3903800, -2539125, -146013, -970469, -2716716, 96875, 3969584, 668245, -4181429, 1293203, 3266376, 549674, -2159783, 2267070, 2478957, 3972409, -3207650, 32069, -3553306, -4356295, -1047595, 2110172, -3112961, 687675, 3331566, -884119, 3417600, 4159985, 441876, 3223216, -575210, -3746620, 23210, 3771438, -3987361, 4120616, -3410633, 3628464, -676185, 1470649, 1359145, 711441, 605036, 2748537, -2666659, -362733, -2282813, 3905661, -1384759, -2744230, -571207, 3696595, -4338785, -2440159, -142183, -3664667, -4365753, 1338583, -1084212, -1271492, 3477306, 4176864, 3239793, -508972, 505174, 4329824, 1367064, 2138670, -278783, 653426, 2711681, -3811433, -2106275, -677242, -3652560, 4224097, -695999, -2549836, 3411556, 2885480, -2821606, -786436, 3646196, -3343733, -1596402, 1099206, 2806524, 3989037, 2480305, 290334, -4244707, -3399132, 3728120, 4374007, -2536652, 129399, -1114368, 735816, 2989604, 2851426, 1016667, 3951801, -1899344, 2022865, -1936555, -1984357, -2054196, 3792541, 3267423, 4022277, 4448864, -2784168, 558922, 2060749, 3075967, -3257073, 2216519, -1946789, -1604196, -2319262, -527450, 567624, -1174819, 1763035, -2373091, -1370751, 2924900, -2441617, 671293, -2745651, 2419166, -2187794, -3999318, 2517000, 1699152, -1634291, -2930506, 3828970, -889262, 724150, -1746988, 4107233, 4277255, 1483849, 2980933, 2346013, -733955, -2898050, -919538, -2641436, -2960982, 3131276, -3246894, 1044090, -2793573, 1502913, 2263997, 1636692, -3356643, -120965, 2915390, -1161354, -3672923, 502485, -1440499, 3765115, 4242492, -1413302, -195770, 2970014, -3874950, 2860211, -1687292, 3805676, -2563349, 3382249, -2165554, -1775517, 1148692, -3918448, 3743472, 1922886, 3768772, 1473966, -1105379, -2053620, 558075, -1935431, -1201331, 1849314, -1625491, -3076286, -1468851, 965062, -3130328, 3656651, -1142812, -3665542, -1422203, -1332855, 3805734, 562209, 1699103, 799010, -4265535, 3396898, 1741524, -2947199, -2556463, 458093, -157892, -895757, 3956671, -2465132, 507785, 2125111, 2375615, 4444601, -4000919, -1403305, 438550, -2330795, -341605, -762792, 4142863, -3072262, -2731859, -1486977, -2942168, -118942, 1479759, 601336, -3606877, -3013644, 2338438, 1115346, 3487745, -2364056, -4029471, -3233016, -2256074, -1384217, 407999, 1051345, 2206550, -4152011, 1628075, -856410, 467673, 3869049, 3131841, -4395946, 2696954, -2222193, 2278092, -1985142, -3249023, 2997088, 2982523, -1671652, -3054036, 4200818, 1415065, 1140884, 2215622, -1897431, 2653838, -457978, 2328100, 1092637, -2711390, 1262722, 3011804, 3171608, 178810 };
int32_t montgomery_reduce(int64_t a)
{
    int32_t u, m;
    m = (a * NQINV);
    u = ((int64_t)m * KYBER_Q + a) >> 32;

    return u;
}

int32_t barrett_reduce(int32_t a)
{
    int32_t t;
    const int32_t v = ((1 << 26) + KYBER_Q / 2) / KYBER_Q;

    t = ((int64_t)v * a + (1 << 25)) >> 26;
    t *= KYBER_Q;
    return a - t;
}

static int32_t montgomery_mul(int32_t a, int32_t b)
{
    return montgomery_reduce((int64_t)a * b);
}

void ntt(int32_t r[4096])
{

    int i, j;
    int32_t tz, tp;
    // round 1
    tz = psai[1];
    for (i = 0; i < 2048; i++)
    {
        tp = montgomery_mul(r[i + 2048], tz);
        r[i + 2048] = r[i] - tp;
        r[i] = r[i] + tp;
    }
    // round 2
    for (i = 0; i < 2; i++)
    {
        tz = psai[2 + i];
        for (j = 0; j < 1024; j++)
        {
            tp = montgomery_mul(r[i * 2048 + j + 1024], tz);
            r[i * 2048 + j + 1024] = r[i * 2048 + j] - tp;
            r[i * 2048 + j] = r[i * 2048 + j] + tp;
        }
    }
    // round 3
    for (i = 0; i < 4; i++)
    {
        tz = psai[4 + i];
        for (j = 0; j < 512; j++)
        {
            tp = montgomery_mul(r[i * 1024 + j + 512], tz);
            r[i * 1024 + j + 512] = r[i * 1024 + j] - tp;
            r[i * 1024 + j] = r[i * 1024 + j] + tp;
        }
    }
    // round 4
    for (i = 0; i < 8; i++)
    {
        tz = psai[8 + i];
        for (j = 0; j < 256; j++)
        {
            tp = montgomery_mul(r[i * 512 + j + 256], tz);
            r[i * 512 + j + 256] = r[i * 512 + j] - tp;
            r[i * 512 + j] = r[i * 512 + j] + tp;
        }
    }
    // round 5
    for (i = 0; i < 16; i++)
    {
        tz = psai[16 + i];
        for (j = 0; j < 128; j++)
        {
            tp = montgomery_mul(r[i * 256 + j + 128], tz);
            r[i * 256 + j + 128] = r[i * 256 + j] - tp;
            r[i * 256 + j] = r[i * 256 + j] + tp;
        }
    }
    // round 6
    for (i = 0; i < 32; i++)
    {
        tz = psai[32 + i];
        for (j = 0; j < 64; j++)
        {
            tp = montgomery_mul(r[i * 128 + j + 64], tz);
            r[i * 128 + j + 64] = r[i * 128 + j] - tp;
            r[i * 128 + j] = r[i * 128 + j] + tp;
        }
    }
    // round 7
    for (i = 0; i < 64; i++)
    {
        tz = psai[64 + i];
        for (j = 0; j < 32; j++)
        {
            tp = montgomery_mul(r[i * 64 + j + 32], tz);
            r[i * 64 + j + 32] = r[i * 64 + j] - tp;
            r[i * 64 + j] = r[i * 64 + j] + tp;
        }
    }
    // round 8
    for (i = 0; i < 128; i++)
    {
        tz = psai[128 + i];
        for (j = 0; j < 16; j++)
        {
            tp = montgomery_mul(r[i * 32 + j + 16], tz);
            r[i * 32 + j + 16] = r[i * 32 + j] - tp;
            r[i * 32 + j] = r[i * 32 + j] + tp;
        }
    }
    // round 9
    for (i = 0; i < 256; i++)
    {
        tz = psai[256 + i];
        for (j = 0; j < 8; j++)
        {
            tp = montgomery_mul(r[i * 16 + j + 8], tz);
            r[i * 16 + j + 8] = r[i * 16 + j] - tp;
            r[i * 16 + j] = r[i * 16 + j] + tp;
        }
    }
    // round 10
    for (i = 0; i < 512; i++)
    {
        tz = psai[512 + i];
        for (j = 0; j < 4; j++)
        {
            tp = montgomery_mul(r[i * 8 + j + 4], tz);
            r[i * 8 + j + 4] = r[i * 8 + j] - tp;
            r[i * 8 + j] = r[i * 8 + j] + tp;
        }
    }
    // round 11
    for (i = 0; i < 1024; i++)
    {
        tz = psai[1024 + i];
        for (j = 0; j < 2; j++)
        {
            tp = montgomery_mul(r[i * 4 + j + 2], tz);
            r[i * 4 + j + 2] = r[i * 4 + j] - tp;
            r[i * 4 + j] = r[i * 4 + j] + tp;
        }
    }
}

void invntt(int32_t r[4096])
{
    int i, j;
    int32_t tp, tz;
    // round 1
    for (i = 0; i < 1024; i++)
    {
        tz = psaiinv[1024 + i];
        for (j = 0; j < 2; j++)
        {
            tp = (r[4 * i + j] - r[4 * i + j + 2]);
            r[4 * i + j] = barrett_reduce(r[4 * i + j] + r[4 * i + j + 2]);
            r[4 * i + j + 2] = montgomery_mul(tp, tz);
        }
    }
    // round 2
    for (i = 0; i < 512; i++)
    {
        tz = psaiinv[512 + i];
        for (j = 0; j < 4; j++)
        {
            tp = (r[8 * i + j] - r[8 * i + j + 4]);
            r[8 * i + j] = barrett_reduce(r[8 * i + j] + r[8 * i + j + 4]);
            r[8 * i + j + 4] = montgomery_mul(tp, tz);
        }
    }
    // round 3
    for (i = 0; i < 256; i++)
    {
        tz = psaiinv[256 + i];
        for (j = 0; j < 8; j++)
        {
            tp = (r[16 * i + j] - r[16 * i + j + 8]);
            r[16 * i + j] = barrett_reduce(r[16 * i + j] + r[16 * i + j + 8]);
            r[16 * i + j + 8] = montgomery_mul(tp, tz);
        }
    }
    // round 4
    for (i = 0; i < 128; i++)
    {
        tz = psaiinv[128 + i];
        for (j = 0; j < 16; j++)
        {
            tp = (r[32 * i + j] - r[32 * i + j + 16]);
            r[32 * i + j] = barrett_reduce(r[32 * i + j] + r[32 * i + j + 16]);
            r[32 * i + j + 16] = montgomery_mul(tp, tz);
        }
    }
    // round 5
    for (i = 0; i < 64; i++)
    {
        tz = psaiinv[64 + i];
        for (j = 0; j < 32; j++)
        {
            tp = (r[64 * i + j] - r[64 * i + j + 32]);
            r[64 * i + j] = barrett_reduce(r[64 * i + j] + r[64 * i + j + 32]);
            r[64 * i + j + 32] = montgomery_mul(tp, tz);
        }
    }
    // round 6
    for (i = 0; i < 32; i++)
    {
        tz = psaiinv[32 + i];
        for (j = 0; j < 64; j++)
        {
            tp = (r[128 * i + j] - r[128 * i + j + 64]);
            r[128 * i + j] = barrett_reduce(r[128 * i + j] + r[128 * i + j + 64]);
            r[128 * i + j + 64] = montgomery_mul(tp, tz);
        }
    }
    // round 7
    for (i = 0; i < 16; i++)
    {
        tz = psaiinv[16 + i];
        for (j = 0; j < 128; j++)
        {
            tp = (r[256 * i + j] - r[256 * i + j + 128]);
            r[256 * i + j] = barrett_reduce(r[256 * i + j] + r[256 * i + j + 128]);
            r[256 * i + j + 128] = montgomery_mul(tp, tz);
        }
    }
    // round 8
    for (i = 0; i < 8; i++)
    {
        tz = psaiinv[8 + i];
        for (j = 0; j < 256; j++)
        {
            tp = (r[512 * i + j] - r[512 * i + j + 256]);
            r[512 * i + j] = barrett_reduce(r[512 * i + j] + r[512 * i + j + 256]);
            r[512 * i + j + 256] = montgomery_mul(tp, tz);
        }
    }
    // round 9
    for (i = 0; i < 4; i++)
    {
        tz = psaiinv[4 + i];
        for (j = 0; j < 512; j++)
        {
            tp = (r[1024 * i + j] - r[1024 * i + j + 512]);
            r[1024 * i + j] = barrett_reduce(r[1024 * i + j] + r[1024 * i + j + 512]);
            r[1024 * i + j + 512] = montgomery_mul(tp, tz);
        }
    }
    // round 10
    for (i = 0; i < 2; i++)
    {
        tz = psaiinv[2 + i];
        for (j = 0; j < 1024; j++)
        {
            tp = (r[2048 * i + j] - r[2048 * i + j + 1024]);
            r[2048 * i + j] = barrett_reduce(r[2048 * i + j] + r[2048 * i + j + 1024]);
            r[2048 * i + j + 1024] = montgomery_mul(tp, tz);
        }
    }
    tz = psaiinv[1];
    for (j = 0; j < 2048; j++)
    {
        tp = (r[j] - r[j + 2048]);
        r[j] = barrett_reduce(r[j] + r[j + 2048]);
        r[j + 2048] = montgomery_mul(tp, tz);
    }
    //int32_t f = 2097152;
    int32_t f = 4257859;
    for (j = 0; j < 4096; j++)
    {
        r[j] = montgomery_mul(r[j], f);
    }
}

void basemul(int32_t r[2], const int32_t a[2], const int32_t b[2], int32_t psai)
{
    r[0] = montgomery_mul(a[1], b[1]);
    r[0] = montgomery_mul(r[0], psai);
    r[0] += montgomery_mul(a[0], b[0]);
    r[1] = montgomery_mul(a[0], b[1]);//x^1
    r[1] += montgomery_mul(a[1], b[0]);//x^1
}

void basemul_montgomery(int32_t* r, const int32_t* a, const int32_t* b)
{
    unsigned int i;
    for (i = 0; i < 4096 / 4; i++) {
        basemul(&r[4 * i], &a[4 * i], &b[4 * i], psai[1024 + i]);
        basemul(&r[4 * i + 2], &a[4 * i + 2], &b[4 * i + 2], -psai[1024 + i]);
    }
}
